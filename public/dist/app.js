!function(){"use strict";angular.module("jivoxHack",["ui.router","toaster","ngAnimate"]).config(["$stateProvider","$urlRouterProvider","$httpProvider",function(t,o,n){o.otherwise("/home");var r="src/";t.state("account",{url:"/user",templateUrl:r+"user/account/account.tpl",controller:"AccountController as account"}).state("account.login",{url:"/user/login",templateUrl:r+"user/account/login/login.tpl",controller:"LoginController as login"}).state("account.signup",{url:"/user/signup",templateUrl:r+"user/account/signup/signup.tpl",controller:"SignUpController as signup"}).state("account.logout",{url:"/user",templateUrl:r+"user/account/account.tpl",controller:"AccountController as account"}).state("profile",{url:"/user/profile",templateUrl:r+"user/profile/profile.tpl",controller:"ProfileController as profile"}).state("wishlist",{url:"/user/wishlist",templateUrl:r+"user/wishlist/wishlist.tpl",controller:"WishlistController as wishlist"}).state("order",{url:"/user/order",templateUrl:r+"user/order/order.tpl",controller:"OrderController as order"}).state("cart",{url:"/user/cart",templateUrl:r+"user/cart/cart.tpl",controller:"CartController as cart"}).state("home",{url:"/home",templateUrl:r+"home/home.tpl",controller:"HomeController as home"}).state("products",{url:"/products/:prodId",templateUrl:r+"products/product.tpl",controller:"ProductController as product"}).state("category",{url:"/category/:catId",templateUrl:r+"category/category.tpl",controller:"CategoryController as category"}),n.interceptors.push("authInterceptor")}])}(),function(){angular.module("jivoxHack").factory("authInterceptor",["$rootScope","$q","$window",function(t,o,n){return{request:function(t){return t.headers=t.headers||{},n.localStorage.getItem("token")&&(t.headers.Authorization=n.localStorage.getItem("token")),t},response:function(t){return 401===t.status,t||o.when(t)}}}])}(),function(){"use strict";angular.module("jivoxHack").controller("CategoryController",["Cart","Wishlist","$stateParams","Category",function(t,o,n,r){function e(){l.min_val=Math.min.apply(Math,l.productList.map(function(t){return t.cost})),l.max_val=Math.max.apply(Math,l.productList.map(function(t){return t.cost})),l.sort_val="-cost",l.priceUp=function(){console.log("price"),l.sort_val="-cost"},l.priceDown=function(){console.log("priceDown"),l.sort_val="cost"},l.rating=function(){console.log("rating"),l.sort_val="cum_rating"},l.filter_val="",l.rat=1,l.selRat=function(){},l.options={floor:l.min_val,ceil:l.max_val,step:1},console.log(l)}var c=n.catId;console.log("cat_id",c);var l=this;l.catList=null,l.prodlist=[],l.addToCart=function(o){t.addToCart(o)},l.addToWishlist=function(t){o.postWishes(t).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},r.getCategories().then(function(t){console.log(t),l.catList=t.data.catgList}).catch(function(t){console.log("error:",t)}),l.rclear=function(){delete l.rat,l.rat=0},l.min_val="",l.max_val="",r.getCategoryProducts(c).then(function(t){console.log("Product list",t),l.productList=t.data.products,e()}).catch(function(t){console.log(t)})}])}(),function(){"use strict";angular.module("jivoxHack").factory("Category",["$http","$window",function(t,o){return{getCategoryProducts:function(o){return t.get("/products/category/"+o)},getCategories:function(){return t.get("/category/")}}}])}(),function(){"use strict";angular.module("jivoxHack").controller("HomeController",["$state","$http","Home","$window","$stateParams","Category","Wishlist","Cart","$rootScope",function(t,o,n,r,e,c,l,a,s){var i=this;i.catList=null,i.prodlist=[],n.getCategories().then(function(t){console.log(t),i.catList=t.data.catgList}).catch(function(t){console.log("error:",t)}),i.times=function(t){return new Array(t)},i.getCatProd=function(t){c.getCategoryProducts(t).then(function(t){return console.log(t),t.data.products}).catch(function(t){console.log(t)})},i.addToCart=function(t){a.addToCart(t)},i.addToWishlist=function(t){l.postWishes(t).then(function(t){console.log(t)}).catch(function(t){console.log(t)})};for(var u=3;u>=0;u--)c.getCategoryProducts(u).then(function(t){console.log(t);for(var o=0;o<t.data.products.length;o++)i.prodlist.push(t.data.products[o])}).catch(function(t){console.log(t)});i.viewProd=function(o){console.log(o),s.curProdId=o,t.go("products")},i.search=function(){n.getSearch(i.query).then(function(t){console.log("search",t),i.prodlist=t.data.productList}).catch(function(t){console.log(t)})}}])}(),function(){"use strict";angular.module("jivoxHack").factory("Home",["$http","$window",function(t,o){return{getCategories:function(){return t.get("/category")},getSearch:function(o){return t.post("/search",{search_query:o})}}}])}(),function(){"use strict";angular.module("jivoxHack").controller("ProductController",["$rootScope","$window","$stateParams","Product","Wishlist","Cart",function(t,o,n,r,e,c){var l=this;l.addedToCart=[],l.curProductId=null,l.reviewList=[],l.curProductId=n.prodId;var a=function(){r.getProductDetails(l.curProductId).then(function(t){console.log("details",t),l.productDetails=t.data.products,l.reviewList=t.data.products.ratings,l.pic=t.data.products.photos[0].url,l.vendorId=t.data.products.vendor_id,console.log("re",l.reviewList)}).catch(function(t){console.log(t)})};a(),r.getReview(l.curProductId).then(function(t){console.log("review",t)}).catch(function(t){console.log(t)}),l.addCart=function(){c.addToCart(l.curProductId)},l.addWish=function(){e.postWishes(l.curProductId).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},l.addReview=function(){r.addRating(l.curProductId,{vendor_id:l.vendorId,rating:l.Urating,review:l.Ureview}).then(function(t){a(),console.log(t),l.Ureview="",l.Urating=""}).catch(function(t){console.log(t)})}}])}(),function(){"use strict";angular.module("jivoxHack").factory("Product",["$http","$window",function(t,o){return{getProductDetails:function(o){return t.get("/products/"+o)},addRating:function(o,n){return t.post("/consumer/ratings/"+o,n)},getReview:function(o){return t.get("/ratings/"+o)}}}])}(),function(){"use strict";angular.module("jivoxHack").controller("AccountController",["Account","$state","$window","$rootScope",function(t,o,n,r){var e=this;r.loggedIn=t.isLoggedInFunc(),console.log(t.isloggedIn),e.logout=function(){t.logout(),e.loggedin=!1}}])}(),function(){"use strict";angular.module("jivoxHack").factory("Account",["$http","$window",function(t,o){function n(o){return t.post("/users/signup",o)}function r(n){var r=this;return t.post("/users/login",n).then(function(t){return console.log(t),r.isLoggedIn=!0,i=t.data.token,u=t.data.id,o.localStorage.setItem("token",i),o.localStorage.setItem("user_id",u),console.log("isLoggedin",r.isLoggedIn),t}).catch(function(t){console.log(t)})}function e(){return d=!1,o.localStorage.clear()}function c(){return s()&&a()?(console.log("Logged in"),d=!0,!0):(console.log("no logged in"),d=!1,!1)}function l(){return t.get("/users")}function a(){return u=o.localStorage.getItem("user_id")}function s(){return i=o.localStorage.getItem("token")}var i=null,u=null,d=!1;return{signUp:n,login:r,getUserNames:l,getUserId:a,getToken:s,isLoggedIn:this.isLoggedIn,isLoggedInFunc:c,logout:e}}])}(),function(){"use strict";angular.module("jivoxHack").controller("CartController",["$window","Product","$stateParams","Cart","Order",function(t,o,n,r,e){var c=this;c.prodlist=[];var l=r.getCart();console.log("prod id arr",l);var a=[],s=function(t){for(var n=t.length-1;n>=0;n--)o.getProductDetails(t[n]).then(function(t){console.log(t),c.prodlist.push(t.data.products),a.push({product_id:t.data.products.product_id,vendor_id:t.data.products.vendor_id})}).catch(function(t){console.log(t)})};c.order=function(){e.postOrder({orders:a}).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},console.log(c.prodlist),s(l)}])}(),function(){"use strict";angular.module("jivoxHack").factory("Cart",["$http","$window",function(t,o){return{addToCart:function(t){var n=JSON.parse(o.localStorage.getItem("cart"));n||(n=[]),n.push(t),o.localStorage.setItem("cart",JSON.stringify(n))},getCart:function(){return JSON.parse(o.localStorage.getItem("cart"))}}}])}(),function(){"use strict";angular.module("jivoxHack").controller("OrderController",["Order","$window","$stateParams",function(t,o,n){var r=this;r.allOrders=null,t.getOrders().then(function(t){console.log(t),r.allOrders=t.data.orders}).catch(function(t){console.log(t)})}])}(),function(){"use strict";angular.module("jivoxHack").factory("Order",["$http","$window",function(t,o){return{getOrders:function(){return t.get("/consumer/orders/")},postOrder:function(o){return t.post("/consumer/orders/",o)}}}])}(),function(){"use strict";angular.module("jivoxHack").controller("ProfileController",["$http","$window","$stateParam",function(t,o,n){var r=this;r.update=function(){Profile.postAddress(data).then(function(t){console.log(t)}).catch(function(t){console.log(t)})}}])}(),function(){"use strict";angular.module("jivoxHack").factory("Profile",["$http","$window",function(t,o){return{postAddress:function(o){return t.post("/consumer/address/"+o)}}}])}(),function(){"use strict";angular.module("jivoxHack").controller("WishlistController",["$http","$window","Wishlist","toaster","Product","Cart",function(t,o,n,r,e,c){function l(t){for(var o=t.length-1;o>=0;o--)e.getProductDetails(t[o].product_id).then(function(t){console.log(t),a.prodlist.push(t.data.products)}).catch(function(t){console.log(t)})}var a=this;a.prodlist=[],a.addToCart=function(t){c.addToCart(t).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},n.getWishes().then(function(t){console.log(t),a.wished=t.data.wishlist,l(a.wished)}).catch(function(t){console.log(t),r.pop("error","Sorry","Please log in")})}])}(),function(){"use strict";angular.module("jivoxHack").factory("Wishlist",["$http","$window",function(t,o){return{getWishes:function(){return t.get("/consumer/wishlist/")},postWishes:function(o){return t.post("/consumer/wishlist/",{product_id:o})}}}])}(),function(){"use strict";angular.module("jivoxHack").controller("LoginController",["Account","$state","$rootScope",function(t,o,n){var r=this;n.isSignUp=!1,r.submit=function(){t.login({email:r.email,password:r.password}).then(function(r){console.log(r),console.log("islo",t.isLoggedIn),n.loggedIn=!0,o.go("home")}).catch(function(t){console.log(t),r.Message=t})}}])}(),function(){"use strict";angular.module("jivoxHack").controller("SignUpController",["Account","$state","$rootScope",function(t,o,n){var r=this;r.message="",r.enable=!1,n.isSignUp=!0,r.checkUserName=function(){t.getUserNames().then(function(t){if(t.data)if("[object Array]"===Object.prototype.toString.call(t.data.username)){var o=t.data.indexOf(r.email);o!==-1&&(r.message="You have already signed up....",r.enable=!1)}else r.message="",r.enable=!0;else r.enable=!0}).catch(function(t){console.log(t)})},r.submit=function(){console.log(r);var n={name:r.name,password:r.password,email:r.email};t.signUp(n).then(function(r){t.login({email:n.email,password:n.password}).then(function(){o.go("home")}).catch(function(t){console.log("During login!!"),console.log(t)})}).catch(function(t){console.log(t)})}}])}();